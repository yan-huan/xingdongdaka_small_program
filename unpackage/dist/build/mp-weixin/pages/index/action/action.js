(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/action/action"],{"1f97":function(t,e,n){"use strict";var s=n("959e"),i=n.n(s);i.a},"5cdb":function(t,e,n){"use strict";n.r(e);var s=n("ca94"),i=n("d111");for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("1f97");var r,a=n("f0c5"),u=Object(a["a"])(i["default"],s["b"],s["c"],!1,null,"3bfbb325",null,!1,s["a"],r);e["default"]=u.exports},"7a59":function(t,e,n){"use strict";(function(t){n("4e6c"),n("921b");s(n("66fd"));var e=s(n("5cdb"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"959e":function(t,e,n){},b0af:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=o(n("4795")),i=n("2f62");function o(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,s,i,o,r){try{var a=t[o](r),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(s,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(s,i){var o=t.apply(e,n);function a(t){r(o,s,i,a,u,"next",t)}function u(t){r(o,s,i,a,u,"throw",t)}a(void 0)}))}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(){n.e("components/lookerCountInfo").then(function(){return resolve(n("08b4"))}.bind(null,n)).catch(n.oe)},l={components:{lookerCountInfo:h},data:function(){return{TabCur:0,pushComentList:[],pusCardList:[],pushList:{},modal:!1,addrAnimation:"",audioPlaySrc:"../../../static/images/icon/img/titl.png",userId:t.getStorageSync("id"),lookerList:[],looktotal:"",lookNextPageTwo:"",pushId:"",isShare:0,guanzhu:"关注"}},computed:c({},(0,i.mapState)(["hasLogin"])),onLoad:function(e){if(wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]}),void 0==e.pushList){if(this.pushId=e.pushId,this.isShare=e.isopen?e.isopen:0,void 0!=e.share)try{t.setStorageSync("share",e.share)}catch(n){console.log(Error)}this.getpushList(),this.getPushCardList(),this.clickSaveShareInfo()}},onShareAppMessage:function(t){var e=this;return"menu"==t.from?e.xdUniUtils.xd_onShare():e.pusCardList.length>0?(e.setSaveShareInfo(),{title:e.pushList.userId==e.userId?"第"+e.pushList.pushCardCishuCount+"次打卡:"+e.pusCardList[0].content:"我为@"+e.pushList.userName+"打Call："+e.pusCardList[0].content,path:"/pages/index/action/action?pushId="+e.pushList.id+"&share="+e.pushList.userId+"&isopen="+e.pushList.isopen,imageUrl:e.pusCardList[0].pictures[0]?e.pusCardList[0].pictures[0]:"https://chucun2019.oss-cn-beijing.aliyuncs.com/dynamic/1595733463227.png"}):(e.setSaveShareInfo(),{title:e.pushList.userId==e.userId?"第"+e.pushList.pushCardCishuCount+"次打卡:"+e.pushList.content:"我为@"+e.pushList.userName+"打Call："+e.pushList.content,path:"/pages/index/action/action?pushId="+e.pushList.id+"&share="+e.pushList.userId+"&isopen="+e.pushList.isopen,imageUrl:e.pushList.pictures?e.pushList.pictures:"https://chucun2019.oss-cn-beijing.aliyuncs.com/dynamic/1595733463227.png"})},methods:{showBanner:function(t,e){this.$refs.lookerCountInfo.showBanner(t,e)},compareDate:function(t,e){return"undefined"==typeof t||("undefined"==typeof e||this.xdUniUtils.xd_timestampToTime(t.createTime,!1,!1,!1)>this.xdUniUtils.xd_timestampToTime(e.createTime,!1,!1,!1))},gostep:function(){t.navigateTo({url:"../../action/step1"})},tabSelect:function(t){this.TabCur=t.target.id,1==this.TabCur&&this.getLookerList()},setSaveShareInfo:function(){this.xd_request_post(this.xdServerUrls.xd_saveShareInfo,{pushId:this.pushId,shareUserId:this.userId},!0).then((function(t){}))},clickSaveShareInfo:function(){var e=this;""!=t.getStorageSync("share")&&void 0!=this.userId&&this.xd_request_post(this.xdServerUrls.xd_saveShareInfo,{pushId:this.pushId,shareUserId:t.getStorageSync("share"),clickUserId:this.userId},!0).then((function(t){e.getpushList()}))},goUser:function(e){if(!t.getStorageSync("token"))return t.navigateTo({url:"../../login/login"}),!1;t.navigateTo({url:"../../selfCenter/selfView?userId="+e})},lookerClick:function(e,n){var s=this;if(!t.getStorageSync("token"))return t.navigateTo({url:"../../login/login"}),!1;s.userId=t.getStorageSync("id"),s.xd_request_post(s.xdServerUrls.xd_saveLooker,{pushId:e.id,lookUserId:s.userId},!0).then((function(e){0==e.resultCode?(s.pushList.onlooker=!0,s.pushList.onlookerCount++,1!=t.getStorageSync((new Date).toLocaleDateString()+"dycwgKey")?t.showModal({content:s.xdCommon.gzsm_wgglts,showCancel:!1,buttonText:"知道了",success:function(e){e.confirm?t.setStorageSync((new Date).toLocaleDateString()+"dycwgKey",1):e.cancel&&t.setStorageSync((new Date).toLocaleDateString()+"dycwgKey",1)}}):t.showToast({title:"围观成功",duration:1e3,icon:"none"})):t.showToast({title:e.msg,duration:1e3,icon:"none"})}))},goSteps:function(){t.navigateTo({url:"../../selfCenter/clockIn?pushId="+this.pushList.id})},goPageImg:function(t,e){this.xdUniUtils.xd_showImg(t,e)},error:function(){this.audioPlaySrc=this.xdUniUtils.xd_randomImg()},gocardComentList:function(e,n){if(!t.getStorageSync("token"))return t.navigateTo({url:"../../login/login"}),!1;t.navigateTo({url:"../cardDetails/cardDetails?pushId="+e.pushId+"&cardId="+e.id+"&show="+n})},cardComentList:function(e){var n=[];if(n.push(e),this.pushList.pushCardList.length<=0){var s={id:e.id,userId:e.userId};this.pushList.pushCardList.push(s)}var i={pushList:this.pushList,pushCardList:n};t.navigateTo({url:"../cardDetails/cardDetails?pushCard="+encodeURIComponent(JSON.stringify(i))})},timeStamp:function(t){for(var e=t.obj,n=0;n<t.obj.length;n++){var s=this.xdUniUtils.xd_timestampToTime(t.obj[n].createTime,!0);e[n].createTime=s}return e},openAddr:function(){t.navigateTo({url:"../cardDetails/cardDetails?pushList="+encodeURIComponent(JSON.stringify(this.pushList))})},getpushList:function(){var e=this;return a(s.default.mark((function n(){return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(1!=e.isShare){n.next=4;break}if(t.getStorageSync("token")){n.next=4;break}return t.navigateTo({url:"../../login/login"}),n.abrupt("return",!1);case 4:e.xd_request_post(e.xdServerUrls.xd_pushDataByPushId,{pushId:e.pushId,isShare:e.isShare,lookUserId:t.getStorageSync("id")},!0).then((function(n){if(0==n.resultCode){var s=n.obj;s.createTime=e.xdUniUtils.xd_timestampToTime(n.obj.createTime),s.endTime=e.xdUniUtils.xd_timestampToTime(n.obj.endTime),s.challengeRmb=n.obj.challengeRmb/100,e.pushList=s,e.pushList.userId==t.getStorageSync("id")?e.guanzhu="":e.xd_request_post(e.xdServerUrls.xd_iSAttention,{userId:t.getStorageSync("id"),attentionUserId:e.pushList.userId},!0).then((function(t){t.obj?e.guanzhu="已关注":e.guanzhu="关注"}))}else t.showToast({title:n.msg,icon:"none"})}));case 5:case"end":return n.stop()}}),n)})))()},goStep:function(){t.navigateTo({url:"/pages/action/step1"})},getPushComenList:function(){var e=this;this.xd_request_post(this.xdServerUrls.xd_showCommentAndReplayCommtent,{pushId:this.pushId,token:t.getStorageSync("token")},!1).then((function(t){e.pushComentList=e.timeStamp(t)}))},getPushCardList:function(){var t=this;return a(s.default.mark((function e(){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.xd_request_post(t.xdServerUrls.xd_pushCardListByPushId,{pushId:t.pushId},!0).then((function(e){for(var n=e.obj.list,s=0;s<e.obj.list.length;s++)""!=e.obj.list[s].pictures&&(n[s].pictures=e.obj.list[s].pictures.split(","));t.pusCardList=n}));case 1:case"end":return e.stop()}}),e)})))()},cardFn:function(){this.active=0},detailFn:function(){this.active=1},lookFn:function(){this.active=2,this.getLookerList()},tags:function(){var e=this;if(!t.getStorageSync("token"))return t.navigateTo({url:"../../login/login"}),!1;"已关注"!=this.guanzhu&&this.xd_request_post(this.xdServerUrls.xd_saveAttention,{userId:t.getStorageSync("id"),attentionUserId:this.pushList.userId},!0).then((function(n){0==n.resultCode?(e.guanzhu="已关注",t.showToast({icon:"none",title:"关注成功"})):t.showToast({icon:"none",title:n.msg})}))},getLookerList:function(){var e=this;this.xd_request_post(this.xdServerUrls.xd_getLookerByPushId,{pushId:this.pushId,pageNum:this.lookNextPageTwo,pageSize:10},!0).then((function(n){e.lookerList=n.obj.list,e.looktotal=n.obj.total,e.lookNextPageTwo=n.obj.nextPage,e.lookerList.forEach((function(n){n.lookUserId==t.getStorageSync("id")&&(e.guanzhu="已关注")}))}))}}};e.default=l}).call(this,n("543d")["default"])},ca94:function(t,e,n){"use strict";var s,i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.pusCardList,(function(e,n){var s=t.__get_orig(e),i=0==t.TabCur?t.compareDate(t.pusCardList[n-1],e):null,o=0!=t.TabCur||0!=n&&!e.m0?null:t.xdUniUtils.xd_timestampToTime(e.createTime,!1,!1,!1);return{$orig:s,m0:i,g0:o}})));t.$mp.data=Object.assign({},{$root:{l0:n}})},o=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s}))},d111:function(t,e,n){"use strict";n.r(e);var s=n("b0af"),i=n.n(s);for(var o in s)"default"!==o&&function(t){n.d(e,t,(function(){return s[t]}))}(o);e["default"]=i.a}},[["7a59","common/runtime","common/vendor"]]]);
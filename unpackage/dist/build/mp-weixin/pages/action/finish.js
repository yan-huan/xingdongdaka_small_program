(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/action/finish"],{"213f":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2f62");function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={data:function(){return{rmb:{challengeRmb:5},formData:{},saveData:{},pushData:"",payNum:0,mony:0,gzsm_wxfk:this.xdCommon.gzsm_wxfk}},computed:s({},(0,a.mapState)(["hasLogin"])),onLoad:function(t){this.formData=JSON.parse(decodeURIComponent(t.data))},methods:s({},(0,a.mapMutations)(["logOut"]),{timeType:function(t){var e=t.obj,n=this.xdUniUtils.xd_timestampToTime(e.createTime);return e.createTime=n,e.challengeRmb=Math.trunc(e.challengeRmb/100),e},formSubmit:function(e){if(!this.hasLogin)return t.navigateTo({url:"../login/login"}),!1;var n=this,a={token:"",userId:""};try{a.token=t.getStorageSync("token"),a.userId=t.getStorageSync("id")}catch(e){}5==n.rmb.challengeRmb?n.saveData=Object.assign(n.formData,e.detail.value,a):n.saveData=Object.assign(n.formData,n.rmb,a),console.log("formSubmit------ that.saveData",n.saveData),(0==n.saveData.challengeRmb||""==n.saveData.challengeRmb)&&(""==e.detail.value.challengeRmb||e.detail.value.challengeRmb<=0)?(n.saveData.challengeRmb=0,console.log("formSubmit------33333 that.saveData",n.saveData),n.xd_request_post(n.xdServerUrls.xd_savePush,n.saveData,!0).then((function(e){0==e.resultCode?t.showToast({title:"发布成功",icon:"success",duration:2e3,success:function(){t.setStorageSync("pushData",""),t.reLaunch({url:"../index/action/action?pushId="+e.obj.id})}}):t.showToast({title:e.obj,icon:"none",duration:3e3,success:function(){return!1}})}))):(n.mony=100*n.saveData.challengeRmb,n.getPushId())},updataPushId:function(){console.log("updataPushId------");var t=this;t.xd_request_post(t.xdServerUrls.xd_updatePushDataByPushId,{id:t.pushData.obj.id,challengeRmb:0},!0).then((function(t){}))},getPushId:function(){var e=this,n=this;n.saveData.challengeRmb=100*n.saveData.challengeRmb,console.log("getPushId----------",n.saveData),this.xd_request_post(this.xdServerUrls.xd_savePush,this.saveData,!0).then((function(n){console.log("xd_request_post----------",n),0==n.resultCode?(e.pushData=n,1!=n.obj.payWay?e.goPay():t.showToast({title:"发布成功",icon:"success",duration:2e3,success:function(){t.setStorageSync("pushData",""),t.reLaunch({url:"../index/action/action?pushId="+n.obj.id})}})):t.showToast({title:n.obj,icon:"none",duration:3e3,success:function(){return!1}})}))},priceRmb:function(t){this.rmb.challengeRmb=t,this.formSubmit()},goPay:function(){var e=this,n=this,a={id:"",userName:"",token:"",unionId:"",openid:"",city:"",province:"",payRmb:"",pushId:""},o={};try{o=t.getStorageSync("userInfo")}catch(s){}a.id=n.saveData.userId,a.token=n.saveData.token,a.city=o.city,a.userName=o.nickName,a.province=o.province,a.unionId=o.unionId,a.openid=o.openId,a.payRmb=n.mony,a.pushId=n.pushData.obj.id,wx.getSetting({success:function(o){console.log("wx.getSetting----",o,a),o.authSetting["scope.userInfo"]?n.xd_request_post(n.xdServerUrls.xd_pay,a,!1).then((function(e){t.requestPayment({appId:e.obj.appId,timeStamp:e.obj.timeStamp,nonceStr:e.obj.nonceStr,package:e.obj.packageAlias,signType:"MD5",paySign:e.obj.paySign,success:function(e){t.showToast({title:"发布成功",icon:"success",duration:2e3,success:function(){t.setStorageSync("pushData",""),t.reLaunch({url:"../index/action/action?pushId="+n.pushData.obj.id})}})},fail:function(e){n.updataPushId(),t.showModal({content:"支付取消",confirmText:"重新填写",cancelText:"回到首页",image:"/static/images/icon/clock.png",success:function(e){e.confirm?(t.setStorageSync("pushData",n.pushData.obj),t.reLaunch({url:"step1"})):e.cancel&&(t.setStorageSync("pushData",n.pushData.obj),t.reLaunch({url:"../index/index"}))}})}})})):(e.logOut(),t.navigateTo({url:"../login/login"}))}})}})};e.default=u}).call(this,n("543d")["default"])},2662:function(t,e,n){"use strict";n.r(e);var a=n("213f"),o=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=o.a},"75f4":function(t,e,n){"use strict";n.r(e);var a=n("9b96"),o=n("2662");for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);n("cf5b");var c,u=n("f0c5"),i=Object(u["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],c);e["default"]=i.exports},"9b96":function(t,e,n){"use strict";var a,o=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}))},b021:function(t,e,n){},cf5b:function(t,e,n){"use strict";var a=n("b021"),o=n.n(a);o.a},fbc1:function(t,e,n){"use strict";(function(t){n("4e6c"),n("921b");a(n("66fd"));var e=a(n("75f4"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["fbc1","common/runtime","common/vendor"]]]);
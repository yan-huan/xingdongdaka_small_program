(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/action/action"],{"203a":function(t,e,n){"use strict";(function(t){n("4e6c"),n("921b");i(n("66fd"));var e=i(n("5272"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"31f4":function(t,e,n){"use strict";n.r(e);var i=n("c559"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},5272:function(t,e,n){"use strict";n.r(e);var i=n("b480"),a=n("31f4");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("f88a");var r,s=n("f0c5"),c=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);e["default"]=c.exports},"57c7":function(t,e,n){},b480:function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))},c559:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("2f62");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(){n.e("components/actionlist").then(function(){return resolve(n("4f87"))}.bind(null,n)).catch(n.oe)},c={data:function(){return{vi:1,tab:0,userId:t.getStorageSync("id"),cardList:[],lookerList:[],maskState:0,nextPage:1,pageSize:10,nextPageTwo:"",total:"",looktotal:"",pushId:"",index:""}},onShow:function(){},onLoad:function(){this.inDada(this.tab),wx.showShareMenu({menus:["shareAppMessage","shareTimeline"]})},computed:o({},(0,i.mapState)(["hasLogin"])),onShareAppMessage:function(e){var n=this;return"menu"==e.from?n.xdUniUtils.xd_onShare():0==n.tab?{title:"第"+n.cardList[e.target.id].pushCardCishuCount+"次打卡:"+n.cardList[e.target.id].content,path:"/pages/index/action/action?pushId="+n.cardList[e.target.id].id+"&share="+t.getStorageSync("id")+"&isopen="+n.cardList[e.target.id].isopen,imageUrl:n.cardList[e.target.id].pictures?n.cardList[e.target.id].pictures:"https://chucun2019.oss-cn-beijing.aliyuncs.com/dynamic/1595733463227.png"}:1==n.tab?{title:"我为@"+n.lookerList[e.target.id].userName+"打Call："+n.lookerList[e.target.id].content,path:"/pages/index/action/action?pushId="+n.lookerList[e.target.id].id+"&share="+t.getStorageSync("id")+"&isopen="+n.lookerList[e.target.id].isopen,imageUrl:n.lookerList[e.target.id].pictures?n.lookerList[e.target.id].pictures:"https://chucun2019.oss-cn-beijing.aliyuncs.com/dynamic/1595733463227.png"}:void 0},methods:{tabs:function(t){this.tab=t,0==t?this.inDada(0):1==t&&this.inDada(1)},setSaveShareInfo:function(e){this.xd_request_post(this.xdServerUrls.xd_saveShareInfo,{pushId:this.cardList[e.target.id].id,shareUserId:t.getStorageSync("id")},!0).then((function(t){}))},creatXd:function(e){var n=this,i=n.pushId,a=n.index;1==e&&2!=n.cardList[a].btn?t.showModal({title:"重新编辑行动",content:"将删除原行动及打卡信息，在重新发布新行动",success:function(o){o.confirm?n.xd_request_post(n.xdServerUrls.xd_delPushDataByPushId,{pushid:i},!0).then((function(i){0==i.resultCode&&t.showToast({title:"删除成功，将重新编辑",icon:"none",duration:1500,success:function(){try{t.setStorageSync("pushData",n.cardList[a])}catch(e){}t.navigateTo({url:"step1"})}})})):o.cancel&&(n.maskState=0)}}):2==e&&2!=n.cardList[a].btn&&t.showModal({title:"删除行动",content:"删除后无法恢复，相关打卡也会被删除",success:function(e){e.confirm?n.xd_request_post(n.xdServerUrls.xd_delPushDataByPushId,{pushid:i},!0).then((function(e){0==e.resultCode&&(t.showToast({title:"删除成功",icon:"none",duration:1500}),n.cardList.splice(a,1))})):e.cancel&&(n.maskState=0)}})},toggleMask:function(t,e){var n=this,i=t>=0?10:300,a=t>=0?1:0;this.maskState=2,this.pushId=t,this.index=e,setTimeout((function(){n.maskState=a}),i)},toAction:function(e){t.navigateTo({url:"../index/action/action?pushId="+e})},goStep:function(){t.navigateTo({url:"/pages/action/step1"})},inDada:function(e){var n="",i="",a=this;if(!a.hasLogin)return t.redirectTo({url:"../login/login"}),!1;try{n=t.getStorageSync("token"),i=t.getStorageSync("id")}catch(o){}0==e?a.xd_request_post(a.xdServerUrls.xd_pushByUserIdList,{token:n,userId:i,pageNum:1,pageSize:10},!0).then((function(t){a.cardList=a.dataPaly(t),a.nextPage=t.obj.nextPage,a.total=t.obj.total})).catch((function(t){console.log(t)})):a.xd_request_post(a.xdServerUrls.xd_lookerPushListByUserId,{userId:t.getStorageSync("id"),pageNum:1,pageSize:10},!0).then((function(t){a.lookerList=t.obj.list,a.nextPageTwo=t.obj.nextPage,a.looktotal=t.obj.total,a.lookerList.forEach((function(t){"undefined"!=typeof t.challengeRmb&&""!=t.challengeRmb&&"0"!=t.challengeRmb&&(t.challengeRmb=Math.floor(t.challengeRmb/100)),"undefined"===typeof t.pictures||""==t.pictures?t.pictures=a.xdUniUtils.xd_randomImg():t.pictures.indexOf(",")>-1&&(t.pictures=t.pictures.split(",")[0])}))})).catch((function(t){console.log(t)}))},getReachList:function(){var e=this;if(0==e.tab){if(0==e.nextPage)return t.showLoading({title:"没有更多数据了"}),setTimeout((function(){t.hideLoading()}),1e3),!1;t.showLoading({title:"加载中..",mask:!0}),e.xd_request_post(e.xdServerUrls.xd_pushByUserIdList,{token:t.getStorageSync("token"),userId:t.getStorageSync("id"),pageNum:e.nextPage,pageSize:e.pageSize},!1).then((function(n){e.nextPage=n.obj.nextPage;var i=e.dataPaly(n);e.cardList=e.cardList.concat(i),setTimeout((function(){t.hideLoading()}),1e3)}))}else if(1==e.tab){if(0==e.nextPageTwo)return t.showLoading({title:"没有更多数据了"}),setTimeout((function(){t.hideLoading()}),1e3),!1;t.showLoading({title:"加载中..",mask:!0}),e.xd_request_post(e.xdServerUrls.xd_lookerPushListByUserId,{userId:t.getStorageSync("id"),pageNum:e.nextPageTwo,pageSize:10},!0).then((function(n){var i=n.obj.list;e.nextPageTwo=n.obj.nextPage,i.forEach((function(t){"undefined"!=typeof t.challengeRmb&&""!=t.challengeRmb&&"0"!=t.challengeRmb&&(t.challengeRmb=Math.floor(t.challengeRmb/100)),"undefined"===typeof t.pictures||""==t.pictures?t.pictures=e.xdUniUtils.xd_randomImg():t.pictures.indexOf(",")>-1&&(t.pictures=t.pictures.split(",")[0])})),e.lookerList=e.lookerList.concat(i),setTimeout((function(){t.hideLoading()}),1e3)})).catch((function(t){console.log(t)}))}},dataPaly:function(t){var e=t.obj.list,n=new Date;n=n.getTime();for(var i=0;i<e.length;i++){var a=e[i].targetDay-e[i].pushCardCount,o=e[i].targetDay,r=e[i].targetDay+e[i].holidayDay,s=e[i].pushCardCount,c=new Date(e[i].createTime),u=new Date(c.setDate(c.getDate()+r));u=u.getTime();var d=Math.round((n-u)/864e5);a>0&&d<=0?e[i].btn=0:o>s&&d>0?e[i].btn=1:0==a&&o==s&&(e[i].btn=2),e[i].challengeRmb=Math.floor(e[i].challengeRmb/100)}return e}},onReachBottom:function(){this.getReachList()},onPullDownRefresh:function(){this.inDada(this.tab)},components:{actionlist:s}};e.default=c}).call(this,n("543d")["default"])},f88a:function(t,e,n){"use strict";var i=n("57c7"),a=n.n(i);a.a}},[["203a","common/runtime","common/vendor"]]]);